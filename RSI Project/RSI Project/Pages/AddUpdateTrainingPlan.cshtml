@page
@model RSI_Project.Pages.AddUpdateTrainingPlanModel
@{
    ViewData["Title"] = "Add/Update Training Plan";
}

<style>
    .flexbox-container {
        display: flex;
        background-color: black;
        border-radius: .4em;
        overflow: hidden;
        padding: .1em;
        margin: .1em;
    }

    .break {
        flex-basis: 100%;
        height: 0;
    }

    .item {
        flex-grow: 1;
        background-color: white;
        border-radius: 0.4em;
    }

    .item-none {
        flex-grow: 1;
        background-color: white;
    }

    .item-left {
        flex-grow: 1;
        background-color: white;
        border-top-left-radius: 0.4em;
        border-bottom-left-radius: 0.4em;
    }

    .item-right {
        flex-grow: 1;
        background-color: white;
        border-top-right-radius: 0.4em;
        border-bottom-right-radius: 0.4em;
    }

    .margins {
        margin: .1em;
    }

    textarea {
        width: 90%;
        background-color: #f0f0f0;
        color: black;
        border: 2px solid #718391;
        margin: 0.5em auto 1em auto;
        resize: none;
    }

    .noPlan {
        width: 25%;
        margin: 0 auto;
        background-color: white;
        padding-top: 0.75em;
        padding-bottom: 0.75em;
        border: 2px solid black;
        border-radius: 0.4em;
    }
</style>

<div class="text-center">
    @if (Model.activeTraining != null)
    {
        <h1>Edit Training Plan</h1>
    }
    else
    {
        <h1>Add Training Plan</h1>
    }
    <br />
</div>


<div class="text-center" style="font-size: 1.2em;">
    <form id="savePlan" asp-page-handler="save" method="post">
        <input type="hidden" name="trainingId" value="@Model.activeTraining.trainingPlanID" />
        <input type="hidden" name="empId" value="@Model.employee.empIntID" />
        <div class="flexbox-container">
            <div class="item-left margins">
                <p style="margin: 0.5em 0;">
                    Status:
                    <select name="statusId">
                        @foreach (var status in Model.statuses)
                        {
                            if (Model.activeTraining.statusID == status.statusID)
                            {
                                <option value="@status.statusID" selected>@status.statusName</option>
                            }
                            else
                            {
                                <option value="@status.statusID">@status.statusName</option>
                            }
                        }
                    </select>
                </p>
            </div>
            <div class="item-none margins">
                <p style="margin: 0.5em 0;">
                    Medium:
                    <select name="mediumId">
                        @foreach (var medium in Model.media)
                        {
                            if (Model.activeTraining.mediumID == medium.mediumID)
                            {
                                <option value=@medium.mediumID selected>@medium.mediumName</option>
                            }
                            else
                            {
                                <option value=@medium.mediumID>@medium.mediumName</option>
                            }          
                        }
                    </select>
                </p>
            </div>
            <div class="item-none margins">
                <p style="margin: 0.5em 0;">Start Date: <input id="startDate" name="startDate" type="date" required /></p>
                <script>
                    if (@Model.activeTraining.trainingPlanID != 0)
                    {
                        document.getElementById("startDate").value = "@Model.activeTraining.startDate.ToString("yyyy-MM-dd")";
                    }
                </script>
            </div>
            <div class="item-right margins">
                <p style="margin: 0.5em 0;">End Date: <input id="endDate" name="endDate" type="date" required /></p>
                <script>
                    if (@Model.activeTraining.trainingPlanID != 0) 
                    {
                        document.getElementById("endDate").value = "@Model.activeTraining.endDate.ToString("yyyy-MM-dd")";
                    }
                </script>
            </div>
        </div>
        <div class="flexbox-container">
            <div class="item-left margins" style="padding-bottom: 0.75em;">
                <p style="margin: 0.5em 0;">Description</p>
                <textarea name="description" required>@Model.activeTraining.description</textarea>
                <br />
                <button id="saveBtn" class="btn-light" style="border: 1px solid #718391;">Save Plan</button>
            </div>
    </form>
    <div class="item-right margins">
        <p style="margin: 0.5em 0;">Skills</p>
        <table class="table table-striped table-light" style="width: 80%; margin: 0.5em auto;">
            @foreach (var skill in Model.activeTraining.skills)
            {
                <tr>
                    <td>@skill.skillName</td>
                    <!--this should NOT delete the record, rather set the skill as inactive-->
                    <td class="text-end">
                        <form asp-page-handler="remove" method="post">
                           <button class="btn btn-default" style="color:red;">Remove</button>
                           <input type="hidden" name="skillId" value="@skill.skillID" />
                           <input type="hidden" name="trainingPlanId" value="@Model.activeTraining.trainingPlanID" />
                        </form>
                    </td>
                </tr>
            }
        </table>
        <form id="planSkills" asp-page-handler="add" method="post">
            <p>
                <select name="skillId">
                    @foreach (var inactiveSkill in Model.inactiveSkills)
                    {
                        <option value="@inactiveSkill.skillID">@inactiveSkill.skillName</option>
                    }
                </select>
                <input type="hidden" name="trainingPlanId" value="@Model.activeTraining.trainingPlanID" />
                <button class="btn-light" style="border: 1px solid #718391;">Add</button>
            </p>
        </form>
    </div>
</div>


<div class="animation-wrapper">
    <div class="particle particle-1"></div>
    <div class="particle particle-2"></div>
    <div class="particle particle-3"></div>
    <div class="particle particle-4"></div>
</div>

